{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useReducer, useEffect, useState } from 'react';\nimport { projectFirestore, timestamp } from '../firebase/config';\nlet initialState = {\n  document: null,\n  isPending: false,\n  error: null,\n  success: null\n};\nconst firestoreReducer = (state, action) => {\n  switch (action.type) {\n    case \"IS_PENDING\":\n      return {\n        success: false,\n        isPending: true,\n        error: null,\n        document: null\n      };\n    case \"ERROR\":\n      return {\n        success: false,\n        isPending: false,\n        error: action.payload,\n        document: null\n      };\n    case \"ADDED_DOCUMENT\":\n      return {\n        success: true,\n        isPending: false,\n        error: null,\n        document: action.payload\n      };\n    default:\n      return state;\n  }\n};\nexport const useFireStore = collection => {\n  _s();\n  const [response, dispatch] = useReducer(firestoreReducer, initialState);\n  const [isCancelled, setIsCancelled] = useState(false);\n\n  // collection ref\n  const ref = projectFirestore.collection(collection);\n\n  // only dispatch if not cancelled\n  const dispatchIfNotCancelled = action => {\n    if (!isCancelled) {\n      dispatch(action);\n    }\n  };\n\n  // add a document\n  const addDocument = async doc => {\n    dispatch({\n      type: \"IS_PENDING\"\n    });\n    try {\n      const createdAt = timestamp.fromDate(new Date());\n      const addedDocument = await ref.add({\n        ...doc,\n        createdAt\n      });\n      dispatchIfNotCancelled({\n        type: \"ADDED_DOCUMENT\",\n        payload: addedDocument\n      });\n    } catch (err) {\n      dispatchIfNotCancelled({\n        type: \"ERROR\",\n        payload: err.message\n      });\n    }\n  };\n\n  // delete a document\n  const deleteDocument = async doc => {\n    dispatch({\n      type: \"IS_PENDING\"\n    });\n  };\n  useEffect(() => {\n    return () => setIsCancelled(true);\n  }, []);\n  return {\n    addDocument,\n    deleteDocument,\n    response\n  };\n};\n_s(useFireStore, \"9EVgiqay/R51d/Adc6OMNoHTwUQ=\");","map":{"version":3,"names":["useReducer","useEffect","useState","projectFirestore","timestamp","initialState","document","isPending","error","success","firestoreReducer","state","action","type","payload","useFireStore","collection","response","dispatch","isCancelled","setIsCancelled","ref","dispatchIfNotCancelled","addDocument","doc","createdAt","fromDate","Date","addedDocument","add","err","message","deleteDocument"],"sources":["/home/bahubali/Code/Projects/Net ninja react/finance-app/src/hooks/useFireStore.js"],"sourcesContent":["import {useReducer, useEffect, useState}  from 'react';\nimport {projectFirestore,timestamp} from '../firebase/config';\n\nlet initialState = {\n    document:null,\n    isPending:false,\n    error:null,\n    success:null\n}\n\nconst firestoreReducer = (state, action) => {\n    switch (action.type) {\n      case \"IS_PENDING\":\n        return {success: false, isPending: true, error: null, document: null}\n      case \"ERROR\":\n        return {success: false, isPending: false, error: action.payload, document: null}\n      case \"ADDED_DOCUMENT\":\n        return {success: true, isPending: false, error: null, document: action.payload}\n      default:\n        return state\n    }\n  }\n\n  export const useFireStore = (collection) => {\n    const [response, dispatch] = useReducer(firestoreReducer, initialState)\n    const [isCancelled, setIsCancelled] = useState(false)\n\n    // collection ref\n    const ref = projectFirestore.collection(collection)\n\n    // only dispatch if not cancelled\n    const dispatchIfNotCancelled = (action) => {\n      if (!isCancelled) {\n        dispatch(action)\n      }\n    }\n\n    // add a document\n    const addDocument = async (doc) => {\n      dispatch({ type: \"IS_PENDING\" })\n\n      try {\n        const createdAt = timestamp.fromDate(new Date())\n        const addedDocument = await ref.add({...doc, createdAt })\n        dispatchIfNotCancelled({ type: \"ADDED_DOCUMENT\", payload: addedDocument })\n      }\n      catch (err) {\n        dispatchIfNotCancelled({ type: \"ERROR\", payload: err.message })\n      }\n\n    }\n\n    // delete a document\n    const deleteDocument = async (doc) => {\n        dispatch({type:\"IS_PENDING\"})\n        \n    }\n\n    useEffect(() => {\n      return () => setIsCancelled(true)\n    }, [])\n\n    return { addDocument, deleteDocument, response }\n\n  }\n"],"mappings":";AAAA,SAAQA,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACtD,SAAQC,gBAAgB,EAACC,SAAS,QAAO,oBAAoB;AAE7D,IAAIC,YAAY,GAAG;EACfC,QAAQ,EAAC,IAAI;EACbC,SAAS,EAAC,KAAK;EACfC,KAAK,EAAC,IAAI;EACVC,OAAO,EAAC;AACZ,CAAC;AAED,MAAMC,gBAAgB,GAAG,CAACC,KAAK,EAAEC,MAAM,KAAK;EACxC,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,YAAY;MACf,OAAO;QAACJ,OAAO,EAAE,KAAK;QAAEF,SAAS,EAAE,IAAI;QAAEC,KAAK,EAAE,IAAI;QAAEF,QAAQ,EAAE;MAAI,CAAC;IACvE,KAAK,OAAO;MACV,OAAO;QAACG,OAAO,EAAE,KAAK;QAAEF,SAAS,EAAE,KAAK;QAAEC,KAAK,EAAEI,MAAM,CAACE,OAAO;QAAER,QAAQ,EAAE;MAAI,CAAC;IAClF,KAAK,gBAAgB;MACnB,OAAO;QAACG,OAAO,EAAE,IAAI;QAAEF,SAAS,EAAE,KAAK;QAAEC,KAAK,EAAE,IAAI;QAAEF,QAAQ,EAAEM,MAAM,CAACE;MAAO,CAAC;IACjF;MACE,OAAOH,KAAK;EAAA;AAElB,CAAC;AAED,OAAO,MAAMI,YAAY,GAAIC,UAAU,IAAK;EAAA;EAC1C,MAAM,CAACC,QAAQ,EAAEC,QAAQ,CAAC,GAAGlB,UAAU,CAACU,gBAAgB,EAAEL,YAAY,CAAC;EACvE,MAAM,CAACc,WAAW,EAAEC,cAAc,CAAC,GAAGlB,QAAQ,CAAC,KAAK,CAAC;;EAErD;EACA,MAAMmB,GAAG,GAAGlB,gBAAgB,CAACa,UAAU,CAACA,UAAU,CAAC;;EAEnD;EACA,MAAMM,sBAAsB,GAAIV,MAAM,IAAK;IACzC,IAAI,CAACO,WAAW,EAAE;MAChBD,QAAQ,CAACN,MAAM,CAAC;IAClB;EACF,CAAC;;EAED;EACA,MAAMW,WAAW,GAAG,MAAOC,GAAG,IAAK;IACjCN,QAAQ,CAAC;MAAEL,IAAI,EAAE;IAAa,CAAC,CAAC;IAEhC,IAAI;MACF,MAAMY,SAAS,GAAGrB,SAAS,CAACsB,QAAQ,CAAC,IAAIC,IAAI,EAAE,CAAC;MAChD,MAAMC,aAAa,GAAG,MAAMP,GAAG,CAACQ,GAAG,CAAC;QAAC,GAAGL,GAAG;QAAEC;MAAU,CAAC,CAAC;MACzDH,sBAAsB,CAAC;QAAET,IAAI,EAAE,gBAAgB;QAAEC,OAAO,EAAEc;MAAc,CAAC,CAAC;IAC5E,CAAC,CACD,OAAOE,GAAG,EAAE;MACVR,sBAAsB,CAAC;QAAET,IAAI,EAAE,OAAO;QAAEC,OAAO,EAAEgB,GAAG,CAACC;MAAQ,CAAC,CAAC;IACjE;EAEF,CAAC;;EAED;EACA,MAAMC,cAAc,GAAG,MAAOR,GAAG,IAAK;IAClCN,QAAQ,CAAC;MAACL,IAAI,EAAC;IAAY,CAAC,CAAC;EAEjC,CAAC;EAEDZ,SAAS,CAAC,MAAM;IACd,OAAO,MAAMmB,cAAc,CAAC,IAAI,CAAC;EACnC,CAAC,EAAE,EAAE,CAAC;EAEN,OAAO;IAAEG,WAAW;IAAES,cAAc;IAAEf;EAAS,CAAC;AAElD,CAAC;AAAA,GAzCYF,YAAY"},"metadata":{},"sourceType":"module"}